<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MCP Demo Store</title>

  <!-- ✅ Salesforce Personalization (MCP) SDK -->
  <script src="https://cdn.evgjs.com/cloudodysseyitsolutionsltd/salesforce-interactions.min.js"></script>

  <script>
    SalesforceInteractions.init({
      cookieDomain: window.location.hostname
    }).then(() => {

      /* ✅ REQUIRED: initSitemap */
      SalesforceInteractions.initSitemap({
        global: {
          onActionEvent: (event) => event
        },
        pageTypes: [{
          name: "Demo Store Page",
          isMatch: () => true,
          action: () => {}
        }]
      });

      /* ✅ View Product */
      window.viewProduct = function () {
        SalesforceInteractions.sendEvent({
          interaction: { name: "View Product" },
          catalogObject: {
            type: "Product",
            id: "2010456",
            attributes: {
              name: "Demo Jacket",
              price: 199,
              url: window.location.href
            }
          }
        });
        alert("✅ View Product event sent");
      };

      /* ✅ Purchase (ORDER EVENT – CORRECT FORMAT) */
      window.purchaseProduct = function () {
        SalesforceInteractions.sendEvent({
          interaction: { name: "Purchase" },
          order: {
            id: "ORDER-" + Date.now(),
            totalValue: 199,
            currency: "USD"
          },
          lineItems: [{
            catalogObjectType: "Product",
            catalogObjectId: "2010456",
            quantity: 1,
            price: 199
          }]
        });
        alert("✅ Purchase event sent");
      };

    });
  </script>
</head>

<body style="font-family: Arial, sans-serif; padding: 40px;">
  <h1>MCP Demo Store</h1>

  <p><b>Product:</b> Demo Jacket</p>
  <p><b>Price:</b> $199</p>

  <button onclick="viewProduct()">View Product</button>
  <br><br>
  <button onclick="purchaseProduct()">Purchase</button>
</body>
</html>
